{% extends 'base.html' %}

{% block title %}
    价格行情
{% endblock %}


{% block navigation_bar %}
    <nav>
        <ul>
            <li><a href="{{ url_for('index') }}">首页</a></li>
            <li><a href="{{ url_for('map_distribution') }}">产地</a></li>
            <li class="current"><a href="{{ url_for('fruit_2019_price') }}">价格</a></li>
            <li><a href="{{ url_for('recommend') }}">推荐</a></li>
        </ul>
    </nav>
{% endblock %}

{% block echarts %}
    <form action="{{ url_for('fruit_2019_price') }}" method='POST'>
        <select name="type">
            <option value="None">请选择水果种类</option>
            {% for t in types %}
                <option value="{{ t[0] }}">{{ t[0] }}</option>
            {% endfor %}
        </select>
        <select name="month">
            <option value="0">请选择查看时间</option>
            {% for i in range(1,13) %}
                <option value="{{ i }}">{{ i }}</option>
            {% endfor %}
        </select>
        <select name="year">
            <option value="0">是否看全年</option>
            <option value="0">否</option>
            <option value="2019">看2019全年</option>
        </select>
        <button type="submit">查询</button>
    </form>

        <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
    <div id="main" style="width: 1000px;height:400px;"></div>
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text:
                        {% if year == 0 %}
                            '{{ fruit[0][0] }}月份{{ type }}价格波动图',
                        {% else %}
                            '{{ year }}年{{ type }} 价格波动图'
                        {% endif %}
            },
            tooltip: {},
            legend: {
                data:['price']
            },
            xAxis: {
                data: [
                    {% for f in fruit %}
                        '{{ f[0] }}月{{ f[1] }}日',
                    {% endfor %}
                ]
            },
            yAxis: {},
            series: [{
                name: 'price',
                type: 'line',
                data: [
                    {% for f in fruit %}
                        {{ f[2] }},
                    {% endfor %}
                ]
            }]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
{% endblock %}